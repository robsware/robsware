---
layout: page
---

<section class="post">
    <div class="flex-row-between">
    <a href="{{ site.url }}{{ site.baseurl }}/challenges/2023-03-28"> Previous challenge</a>
          <a href="{{ site.url }}{{ site.baseurl }}/"> Home</a>
      <button title="Change theme" id="theme-toggle" onclick="modeSwitcher()">
        <div></div>
      </button>
    </div>
  </section>

<p>These puzzles are generated by chatgpt and some may seem nonsensical or disclose the answer within the code itself. I am still working on those issues and I hope GPT4 will be better at generating them.</p>
<br><p>Can you spot the vulnerability?</p>
<br>
{% highlight html %}
from flask import Flask, render_template, request
import requests

app = Flask(__name__)

@app.route('/')
def index():
    return render_template('index.html')

@app.route('/response', methods=['POST'])
def response():
    target_url = request.form['url']
    response = requests.get(target_url)
    return response.content

if __name__ == '__main__':
    app.run(port=5000)

{% endhighlight %}{% highlight html %}
from flask import Flask, render_template, request
import requests
import re

app = Flask(__name__)

whitelisted_urls = ['https://example.com', 'https://google.com']

@app.route('/')
def index():
    return render_template('index.html')

@app.route('/response', methods=['POST'])
def response():
    target_url = request.form['url']

    if target_url not in whitelisted_urls:
        return "Invalid URL: " + target_url, 400

    if not re.match(r'^https?://(?:[a-z0-9-]+\.)+[a-z]{2,6}(?:/[a-z0-9+.-]+)*$', target_url):
        return "Invalid format for URL: " + target_url, 400

    response = requests.get(target_url)
    return response.content

if __name__ == '__main__':
    app.run(port=5000)

{% endhighlight %}
<br>If you did, ping me at @robsware on twitter to get a Like and a retweet. Answers will be posted next day.

<script src="../../assets/js/main.js?v={{ site.time | date:'%s' }}"></script>