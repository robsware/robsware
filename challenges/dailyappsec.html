---
layout: page
---

<section class="post">
    <div class="flex-row-between">
    <a href="{{ site.url }}{{ site.baseurl }}/challenges/2023-03-27"> Previous challenge</a>
          <a href="{{ site.url }}{{ site.baseurl }}/"> Home</a>
      <button title="Change theme" id="theme-toggle" onclick="modeSwitcher()">
        <div></div>
      </button>
    </div>
  </section>

<p>There prompts are generate by chatgpt and some may seem nonsensical or disclose the answer from the get go. I am still working on those issues and I hope GPT4 will be better at generating them.</p>

<p>Can you spot the vulnerability?</p>
<br>
{% highlight html %}php
<?php
session_start();
$username = $_SESSION['username'] ?? 'Guest';
?>

<!DOCTYPE html>
<html>
<head>
    <title>CSRF Demo</title>
</head>
<body>
    <h1>Welcome, <?php echo $username; ?>!</h1>

    <?php if ($username !== 'Guest'): ?>
    <form method="post" action="update.php">
        <input type="text" name="username" placeholder="Enter your new username">
        <input type="submit" name="submit" value="Update">
    </form>
    <?php endif; ?>
</body>
</html>

{% endhighlight %}{% highlight html %}php
<?php
session_start();

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $username = $_POST['username'];
    
    // Update username in database
    
    $_SESSION['username'] = $username;
    header('Location: index.php');
    exit();
}
?>

{% endhighlight %}
<br>If you did, ping me at @robsware on twitter to get a Like and a retweet. Answers will be posted next day.