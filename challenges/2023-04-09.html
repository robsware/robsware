---
layout: page
---

<section class="post">
    <div class="flex-row-between">
        <a href="{{ site.url }}{{ site.baseurl }}/challenges/2023-04-08"> Previous challenge</a>
             <a href="{{ site.url }}{{ site.baseurl }}/"> Home</a>
      <button title="Change theme" id="theme-toggle" onclick="modeSwitcher()">
        <div></div>
      </button>
    </div>
  </section>
The vulnerability is Missing Authorization
{% highlight html %}csharp
using System;

class Program
{
    static void Main()
    {
        Console.WriteLine("Enter your name:");
        string userName = Console.ReadLine();
        Console.WriteLine("Enter your age:");
        int userAge = Convert.ToInt32(Console.ReadLine());

        if (userAge >= 18)
        {
            Console.WriteLine($"Hello, {userName}. You are authorized to view this content.");            
        }
        else
        {
            Console.WriteLine($"Hello, {userName}. You are not authorized to view this content.");
        }
    }
}

{% endhighlight %}{% highlight c# %}
vulnerable code
{% endhighlight %}vulnerable code

The vulnerable code allows anyone to view the content as long as they are 18 or older. To fix it, we request the user to enter their role (admin or user) and if they are an admin, we ask for their password, then verify it using `VerifyAdminPassword()` function. If the verification is successful, we display the content; otherwise, we print an error message. It's important to note that using a hardcoded password in the code is not a secure practice; therefore, a proper password verification logic should replace the sample shown in this example. The best practice is to store secure hashes of the password and perform any authentication processes against the hashed value, ideally by interacting with a secure database to store the hashed values.

{% highlight c# %}
solution how to fix the vulnerable code
{% endhighlight %}